@page "/licytacja/{Id:int}"

@using Microsoft.AspNetCore.Components.Web

<div class="min-h-screen bg-gray-50 font-sans text-gray-800">

    <section class="max-w-5xl mx-auto px-6 py-16">
        <div class="grid md:grid-cols-2 gap-10">
            <!-- ZDJĘCIE PRZEDMIOTU -->
            <div>
                <img src="@item.ImageUrl" alt="@item.Title" class="rounded-2xl shadow-md w-full object-cover max-h-[500px]" />
            </div>

            <!-- INFORMACJE -->
            <div class="flex flex-col justify-between">
                <div>
                    <h1 class="text-3xl font-bold mb-2">@item.Title</h1>
                    <p class="text-gray-600 mb-6">@item.Description</p>

                    <div class="text-4xl font-bold text-indigo-600">@currentPrice zł</div>
                    <div class="text-sm text-gray-500 mt-1">Ostatnie przebicie: @lastBidAgo</div>
                    <div class="text-sm text-gray-500">Licytujących: @bidders</div>
                </div>

                <!-- POLE LICYTACJI -->
                <div class="mt-10">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Twoja kwota:</label>
                    <input @bind="bidAmount" type="number" class="w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-sm text-lg" />

                    <button @onclick="PlaceBid" class="mt-4 w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">
                        Przebij ofertę
                    </button>

                    @if (bidMessage != null)
                    {
                        <div class="mt-4 text-sm text-green-600">@bidMessage</div>
                    }
                </div>
            </div>
        </div>
    </section>

</div>

@code {
    [Parameter]
    public int Id { get; set; } // z adresu URL

    private AuctionItem item = new("Zegarek sportowy", "Stan idealny, 3 miesiące użytkowania, pasek wymieniony.", "https://prod-api.mediaexpert.pl/api/images/gallery_500_500/thumbnails/images/54/5497862/Zegarek-sportowy-GARMIN-Fenix-7-Pro-Solar-Edition-Szaro-czarny-skos.jpg", 150);
    private int currentPrice = 150;
    private int bidders = 274;
    private string lastBidAgo = "14s temu";
    private int bidAmount;
    private string? bidMessage;

    private void PlaceBid()
    {
        if (bidAmount > currentPrice)
        {
            currentPrice = bidAmount;
            lastBidAgo = "przed chwilą";
            bidders += 1;
            bidMessage = $"Twoja oferta {bidAmount} zł została złożona!";
        }
        else
        {
            bidMessage = "Kwota musi być wyższa niż obecna cena!";
        }
    }

    public class AuctionItem
    {
        public string Title { get; set; }
        public string Description { get; set; }
        public string ImageUrl { get; set; }
        public int Price { get; set; }

        public AuctionItem(string title, string description, string imageUrl, int price)
        {
            Title = title;
            Description = description;
            ImageUrl = imageUrl;
            Price = price;
        }
    }
}